2022-10-19 09:34:56,149 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.55 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:56,232 - distributed.worker_memory - WARNING - Worker is at 81% memory usage. Pausing worker.  Process memory: 1.58 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:56,370 - distributed.worker_memory - WARNING - Worker is at 50% memory usage. Resuming worker. Process memory: 0.98 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:56,507 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-d9000c77cd40663ad657271e7fb29c3d
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f54b19fb4f0>)
kwargs:    {}
Exception: "KeyError('data')"

2022-10-19 09:34:57,313 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.45 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,322 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.49 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,322 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.46 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,334 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.53 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,460 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.49 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,462 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.49 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,557 - distributed.worker_memory - WARNING - Worker is at 83% memory usage. Pausing worker.  Process memory: 1.62 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,586 - distributed.worker_memory - WARNING - Worker is at 90% memory usage. Pausing worker.  Process memory: 1.75 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,587 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.75 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,656 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.72 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,710 - distributed.worker_memory - WARNING - Worker is at 54% memory usage. Resuming worker. Process memory: 1.06 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,711 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.82 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,715 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.83 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,728 - distributed.worker_memory - WARNING - Worker tcp://127.0.0.1:37755 (pid=33455) exceeded 95% memory budget. Restarting...
2022-10-19 09:34:57,744 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.57 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,819 - distributed.worker_memory - WARNING - Worker is at 86% memory usage. Pausing worker.  Process memory: 1.68 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,819 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.68 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:57,847 - distributed.nanny - WARNING - Restarting worker
Distributing data time: 5.019728660583496
partitions: 0 4 0 0
partitions: 0 8 0 0
partitions: 0 12 0 0
partitions: 0 16 0 0
partitions: 0 20 0 0
partitions: 0 24 0 0
partitions: 0 28 0 0
partitions: 0 32 0 0
partitions: 0 36 0 0
partitions: 0 40 0 0
partitions: 0 44 0 0
partitions: 0 48 0 0
partitions: 0 52 0 0
partitions: 0 56 0 0
partitions: 0 60 0 0
partitions: 0 64 0 0
partitions: 0 68 0 0
partitions: 0 72 0 0
partitions: 0 76 0 0
partitions: 0 80 0 0
partitions: 0 84 0 0
partitions: 0 88 0 0
partitions: 0 92 0 0
partitions: 0 96 0 0
partitions: 0 100 0 0
partitions: 0 104 0 0
partitions: 0 108 0 0
partitions: 0 112 0 0
partitions: 0 116 0 0
partitions: 0 120 0 0
partitions: 0 124 0 0
partitions: 0 127 0 0
2022-10-19 09:34:57,877 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-a5f9b2e30776ac1d4b17698d298be456
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f5b022874f0>)
kwargs:    {}
Exception: "KeyError('data')"

2022-10-19 09:34:57,885 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-a4b7c1c016ebf7908f0f80d53620125a
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f330badbe80>)
kwargs:    {}
Exception: "KeyError('data')"

2022-10-19 09:34:57,894 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-031ebf32832ee5192f98d4bcde0db8a8
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f876119be20>)
kwargs:    {}
Exception: "KeyError('data')"

2022-10-19 09:34:57,895 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-bde2b73a2d796c4e7b7744e3627e9ddf
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f7d18e43e50>)
kwargs:    {}
Exception: "KeyError('data')"

2022-10-19 09:34:57,924 - distributed.worker_memory - WARNING - Worker is at 52% memory usage. Resuming worker. Process memory: 1.02 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:58,130 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-d9473008676aa36a5cd67f9d728e5539
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7fd3a1a53640>)
kwargs:    {}
Exception: "CancelledError('DataFrame-591e6169df1cf20ecfa90f1f39ecd116')"

2022-10-19 09:34:58,227 - distributed.worker_memory - WARNING - Worker is at 93% memory usage. Pausing worker.  Process memory: 1.81 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:58,249 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-55bc530e4347b17fd39893973c88cbd0
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7fe7285af6a0>)
kwargs:    {}
Exception: "CancelledError('DataFrame-591e6169df1cf20ecfa90f1f39ecd116')"

2022-10-19 09:34:58,267 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-049186f530f4e345f257cba719f9943b
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7fd225047df0>)
kwargs:    {}
Exception: "CancelledError('DataFrame-591e6169df1cf20ecfa90f1f39ecd116')"

2022-10-19 09:34:58,291 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.94 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:58,292 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.95 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:34:58,329 - distributed.worker_memory - WARNING - Worker tcp://127.0.0.1:36521 (pid=33448) exceeded 95% memory budget. Restarting...
2022-10-19 09:34:58,412 - distributed.nanny - WARNING - Restarting worker
2022-10-19 09:34:58,628 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-81a666bed6ade99ba5f1840002a20f8a
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7fcb62ae9870>)
kwargs:    {}
Exception: "CancelledError('DataFrame-8bb36036d5c8d9794b435d4321ea665c')"

2022-10-19 09:34:58,991 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-c8524f5d561c2b26b4af9bc4af0d829e
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f876119bfd0>)
kwargs:    {}
Exception: "CancelledError('DataFrame-8bb36036d5c8d9794b435d4321ea665c')"

Execution time: 7.247385263442993
Traceback (most recent call last):
  File "/home/ubuntu/forms/benchmark/test_driver.py", line 50, in <module>
    result = fs.compute_formula(df, formula_str)
  File "/home/ubuntu/forms/forms/core/forms.py", line 44, in compute_formula
    res = plan_executor.df_execute_formula_plan(df, root)
  File "/home/ubuntu/forms/forms/executor/dfexecutor/planexecutor.py", line 81, in df_execute_formula_plan
    return res_table.get_table_content()
  File "/home/ubuntu/forms/forms/executor/table.py", line 59, in get_table_content
    self.df = self.remote_df.get_df_content()
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 80, in get_df_content
    [
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/runtime/remoteobject.py", line 33, in get_computed_result
    return self.object_ref.result()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/distributed/client.py", line 277, in result
    raise exc.with_traceback(tb)
  File "/home/ubuntu/forms/forms/executor/dfexecutor/planexecutor.py", line 45, in execute_one_subtree
    res_table = function_executor(physical_subtree)
  File "/home/ubuntu/forms/forms/executor/dfexecutor/basicfuncexecutor.py", line 237, in sumif_df_executor
    df = ref_node.table.get_table_content()
  File "/home/ubuntu/forms/forms/executor/table.py", line 59, in get_table_content
    self.df = self.remote_df.get_df_content()
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 80, in get_df_content
    [
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/runtime/remoteobject.py", line 33, in get_computed_result
    return self.object_ref.result()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/distributed/client.py", line 279, in result
    raise result
concurrent.futures._base.CancelledError: DataFrame-8bb36036d5c8d9794b435d4321ea665c
Get table content time: 0.6799006462097168
Get table content time: 0.3593308925628662
Get table content time: 0.6228122711181641
Get table content time: 1.4951627254486084
Get table content time: 2.646402597427368
Get table content time: 2.946080207824707
Get table content time: 2.995750665664673
Get table content time: 2.1065549850463867
Get table content time: 1.0500564575195312
Get table content time: 1.7079322338104248
Get table content time: 3.538349151611328
Get table content time: 2.945561647415161
Get table content time: 2.0533785820007324
Get table content time: 5.466716289520264
Get table content time: 4.361522674560547
Get table content time: 5.273818731307983
Get table content time: 4.3876214027404785
Get table content time: 5.575649261474609
Get table content time: 3.932126045227051
Get table content time: 5.767400741577148
Get table content time: 4.635010719299316
Get table content time: 5.9822869300842285
