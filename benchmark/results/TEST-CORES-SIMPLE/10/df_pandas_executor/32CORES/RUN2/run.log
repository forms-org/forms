2022-10-19 09:37:00,043 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.48 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,057 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.54 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,558 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.52 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,707 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.50 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,762 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.58 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,844 - distributed.worker_memory - WARNING - Worker is at 81% memory usage. Pausing worker.  Process memory: 1.59 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,845 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.59 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,862 - distributed.worker_memory - WARNING - Worker is at 86% memory usage. Pausing worker.  Process memory: 1.69 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,913 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.69 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,916 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.68 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:00,933 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.55 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,019 - distributed.worker_memory - WARNING - Worker is at 52% memory usage. Resuming worker. Process memory: 1.03 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,028 - distributed.worker_memory - WARNING - Worker is at 83% memory usage. Pausing worker.  Process memory: 1.62 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,044 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.67 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,048 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.66 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,082 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-c0539a9ab54a8826beab18c55b4fe438
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f1d5c95fee0>)
kwargs:    {}
Exception: "KeyError('data')"

2022-10-19 09:37:01,091 - distributed.worker_memory - WARNING - Worker is at 59% memory usage. Resuming worker. Process memory: 1.15 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,187 - distributed.worker_memory - WARNING - Worker is at 54% memory usage. Resuming worker. Process memory: 1.06 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,246 - distributed.worker_memory - WARNING - Worker is at 82% memory usage. Pausing worker.  Process memory: 1.59 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,325 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.69 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,379 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.79 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,382 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.80 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,404 - distributed.worker_memory - WARNING - Worker tcp://127.0.0.1:37143 (pid=34538) exceeded 95% memory budget. Restarting...
2022-10-19 09:37:01,404 - distributed.worker_memory - WARNING - Worker tcp://127.0.0.1:38435 (pid=34551) exceeded 95% memory budget. Restarting...
2022-10-19 09:37:01,484 - distributed.scheduler - ERROR - Couldn't gather keys {'DataFrame-c48b109e273f1abdcfb15ff782b3e7ae': []} state: [None] workers: []
NoneType: None
2022-10-19 09:37:01,484 - distributed.scheduler - ERROR - Shut down workers that don't have promised key: [], DataFrame-c48b109e273f1abdcfb15ff782b3e7ae
NoneType: None
2022-10-19 09:37:01,484 - distributed.client - WARNING - Couldn't gather 1 keys, rescheduling {'DataFrame-c48b109e273f1abdcfb15ff782b3e7ae': ()}
2022-10-19 09:37:01,531 - distributed.nanny - WARNING - Restarting worker
Distributing data time: 5.037171363830566
partitions: 0 4 0 0
partitions: 0 8 0 0
partitions: 0 12 0 0
partitions: 0 16 0 0
partitions: 0 20 0 0
partitions: 0 24 0 0
partitions: 0 28 0 0
partitions: 0 32 0 0
partitions: 0 36 0 0
partitions: 0 40 0 0
partitions: 0 44 0 0
partitions: 0 48 0 0
partitions: 0 52 0 0
partitions: 0 56 0 0
partitions: 0 60 0 0
partitions: 0 64 0 0
partitions: 0 68 0 0
partitions: 0 72 0 0
partitions: 0 76 0 0
partitions: 0 80 0 0
partitions: 0 84 0 0
partitions: 0 88 0 0
partitions: 0 92 0 0
partitions: 0 96 0 0
partitions: 0 100 0 0
partitions: 0 104 0 0
partitions: 0 108 0 0
partitions: 0 112 0 0
partitions: 0 116 0 0
partitions: 0 120 0 0
partitions: 0 124 0 0
partitions: 0 127 0 0
2022-10-19 09:37:01,537 - distributed.nanny - WARNING - Restarting worker
2022-10-19 09:37:01,698 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-e62efc73a3edba2384f453348ddc9a39
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7fcb5faa9f90>)
kwargs:    {}
Exception: "CancelledError('DataFrame-c48b109e273f1abdcfb15ff782b3e7ae')"

2022-10-19 09:37:01,725 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.59 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,769 - distributed.worker_memory - WARNING - Worker is at 81% memory usage. Pausing worker.  Process memory: 1.59 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,769 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.59 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,812 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.81 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:01,841 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-6dcb1a9fc9da5f23663255aa5b89c4ef
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7fd505b73fd0>)
kwargs:    {}
Exception: "CancelledError('DataFrame-e72cda731e7a67227dc7b3ab72568a7d')"

2022-10-19 09:37:01,854 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-90f1607b67c0bf09a8193b72a6081c70
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7effe466bf10>)
kwargs:    {}
Exception: "CancelledError('DataFrame-e72cda731e7a67227dc7b3ab72568a7d')"

2022-10-19 09:37:01,860 - distributed.worker_memory - WARNING - Worker tcp://127.0.0.1:40407 (pid=34600) exceeded 95% memory budget. Restarting...
2022-10-19 09:37:01,947 - distributed.nanny - WARNING - Restarting worker
2022-10-19 09:37:01,948 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-5beea0461cbc2db475d8cd95851dab40
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f7c61734790>)
kwargs:    {}
Exception: "CancelledError('DataFrame-e72cda731e7a67227dc7b3ab72568a7d')"

2022-10-19 09:37:01,994 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.64 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:02,037 - distributed.worker_memory - WARNING - Worker is at 84% memory usage. Pausing worker.  Process memory: 1.65 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:02,037 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.65 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:02,087 - distributed.worker_memory - WARNING - Unmanaged memory use is high. This may indicate a memory leak or the memory may not be released to the OS; see https://distributed.dask.org/en/latest/worker-memory.html#memory-not-released-back-to-the-os for more information. -- Unmanaged memory: 1.78 GiB -- Worker memory limit: 1.94 GiB
2022-10-19 09:37:02,105 - distributed.worker_memory - WARNING - Worker tcp://127.0.0.1:41105 (pid=34545) exceeded 95% memory budget. Restarting...
2022-10-19 09:37:02,146 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-9cf9b3bc4e332c4c96422a0e6cf3865c
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f55c01fbdf0>)
kwargs:    {}
Exception: "KeyError('data')"

2022-10-19 09:37:02,190 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-17f1e70ea6098e1d89c976847aa0909f
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7efde07f2cb0>)
kwargs:    {}
Exception: "CancelledError('DataFrame-503c7d210fc57067757f1009114e4f5b')"

2022-10-19 09:37:02,194 - distributed.nanny - WARNING - Restarting worker
2022-10-19 09:37:02,390 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-b1da35dd401128fdc505b03385ee0096
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7fd504326770>)
kwargs:    {}
Exception: "CancelledError('DataFrame-06e3854753f9ce7030c46a526dc5777d')"

2022-10-19 09:37:02,640 - distributed.worker - WARNING - Compute Failed
Key:       execute_one_subtree-bc33cd0a03bbc05a118a635de94c284d
Function:  execute_one_subtree
args:      (<forms.executor.executionnode.FunctionExecutionNode object at 0x7f1f3c150430>)
kwargs:    {}
Exception: "CancelledError('DataFrame-06e3854753f9ce7030c46a526dc5777d')"

Execution time: 7.679377555847168
Traceback (most recent call last):
  File "/home/ubuntu/forms/benchmark/test_driver.py", line 50, in <module>
    result = fs.compute_formula(df, formula_str)
  File "/home/ubuntu/forms/forms/core/forms.py", line 44, in compute_formula
    res = plan_executor.df_execute_formula_plan(df, root)
  File "/home/ubuntu/forms/forms/executor/dfexecutor/planexecutor.py", line 81, in df_execute_formula_plan
    return res_table.get_table_content()
  File "/home/ubuntu/forms/forms/executor/table.py", line 59, in get_table_content
    self.df = self.remote_df.get_df_content()
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 80, in get_df_content
    [
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/runtime/remoteobject.py", line 33, in get_computed_result
    return self.object_ref.result()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/distributed/client.py", line 277, in result
    raise exc.with_traceback(tb)
  File "/home/ubuntu/forms/forms/executor/dfexecutor/planexecutor.py", line 45, in execute_one_subtree
    res_table = function_executor(physical_subtree)
  File "/home/ubuntu/forms/forms/executor/dfexecutor/basicfuncexecutor.py", line 237, in sumif_df_executor
    df = ref_node.table.get_table_content()
  File "/home/ubuntu/forms/forms/executor/table.py", line 59, in get_table_content
    self.df = self.remote_df.get_df_content()
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 80, in get_df_content
    [
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/executor/dfexecutor/remotedf.py", line 82, in <listcomp>
    [one_partition.remote_obj.get_computed_result() for one_partition in one_row],
  File "/home/ubuntu/forms/forms/runtime/remoteobject.py", line 33, in get_computed_result
    return self.object_ref.result()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/distributed/client.py", line 279, in result
    raise result
concurrent.futures._base.CancelledError: DataFrame-503c7d210fc57067757f1009114e4f5b
Get table content time: 1.8017792701721191
Get table content time: 1.8217909336090088
Get table content time: 0.41968202590942383
Get table content time: 1.3976576328277588
Get table content time: 0.6156477928161621
Get table content time: 1.0332775115966797
Get table content time: 4.717301607131958
Get table content time: 4.544246196746826
Get table content time: 3.886338233947754
Get table content time: 1.2998888492584229
Get table content time: 2.959003210067749
Get table content time: 3.4046177864074707
Get table content time: 2.704479455947876
Get table content time: 2.748455047607422
Get table content time: 4.109416961669922
Get table content time: 3.347524404525757
Get table content time: 5.846495628356934
Get table content time: 4.5155651569366455
Get table content time: 6.0153961181640625
Get table content time: 5.012276649475098
Get table content time: 5.489248037338257
Get table content time: 4.998021602630615
Get table content time: 5.924647569656372
